<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PTO Calendar</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAQAABILAAASCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABYWFgAWFhYAFhYWABYWFgAWFhYAFhYWABYWFgAWFhYAAAAAAAAAAAAAAAAAAAAAAAAAAAAWFhYAFhYWBNYWFhsWFhYqlhYWM1YWFjbWFhY21hYWM1YWFiqWFhYbFhYWBNYWFgAWFhYAAAAAAAAAAAAWFhYE1hYWJtYWFj/WFhY/1hYWP9YWFj/WFhY/1hYWP9YWFj/WFhY/1hYWJtYWFgTWFhYAAAAAAAAAAAAAAAAAFhYWGxYWFj/WFhY/1hYWP9YWFj/WFhY/1hYWP9YWFj/WFhY/1hYWP9YWFhsAAAAAAAAAAAAAAAAAAAAAFhYWKpYWFj/WFhY/1hYWP9YWFj/WFhY/1hYWP9YWFj/WFhY/1hYWP9YWFiqAAAAAAAAAAAAAAAAAAAAAFhYWM1YWFj/WFhY/1hYWP9YWFj/WFhY/1hYWP9YWFj/WFhY/1hYWP9YWFjNAAAAAAAAAAAAAAAAAAAAAFhYWNtYWFj/WFhY/1hYWP9YWFj/WFhY/1hYWP9YWFj/WFhY/1hYWP9YWFjbAAAAAAAAAAAAAAAAAAAAAFhYWNtYWFj/WFhY/1hYWP9YWFj/WFhY/1hYWP9YWFj/WFhY/1hYWP9YWFjbAAAAAAAAAAAAAAAAAAAAAFhYWM1YWFj/WFhY/1hYWP9YWFj/WFhY/1hYWP9YWFj/WFhY/1hYWP9YWFjNAAAAAAAAAAAAAAAAAAAAAFhYWKpYWFj/WFhY/1hYWP9YWFj/WFhY/1hYWP9YWFj/WFhY/1hYWP9YWFiqAAAAAAAAAAAAAAAAAAAAAFhYWGxYWFj/WFhY/1hYWP9YWFj/WFhY/1hYWP9YWFj/WFhY/1hYWP9YWFhsAAAAAAAAAAAAAAAAAAAAAFhYWBNYWFibWFhY/1hYWP9YWFj/WFhY/1hYWP9YWFj/WFhY/1hYWJtYWFgTAAAAAAAAAAAAAAAAWFhYAFhYWABYWFgTWFhYbFhYWKpYWFjNWFhY21hYWNtYWFjNWFhYqlhYWGxYWFgTWFhYAFhYWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="/>
    <style>
        /* Apple-style CSS Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Apple-style Font and Colors */
        :root {
            --apple-blue: #007AFF;
            --apple-red: #FF3B30;
            --apple-green: #34C759;
            --apple-gray: #8E8E93;
            --apple-light-gray: #F2F2F7;
            --apple-border: #C6C6C8;
            --welcome-gradient-start: #1a73e8;
            --welcome-gradient-end: #4285f4;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: linear-gradient(135deg, var(--welcome-gradient-start), var(--welcome-gradient-end));
            color: #1C1C1E;
            line-height: 1.5;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }

        /* Calendar Container Styles */
        .calendar-container {
            background: #FFFFFF;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }

        /* Header Styles */
        .header {
            padding: 1.5rem;
            background-color: var(--apple-light-gray);
            border-bottom: 1px solid var(--apple-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 12px 12px 0 0;
        }

        .title {
            font-size: 1.75rem;
            font-weight: 600;
        }

        /* Fixed-width Controls */
        .controls {
            display: grid;
            grid-template-columns: auto 1fr auto;
            gap: 1rem;
            align-items: center;
            padding: 1rem 1.5rem;
            background-color: #FFFFFF;
            border-bottom: 1px solid var(--apple-border);
        }

        .controls h2 {
            text-align: center;
            margin: 0;
        }

        /* Apple-style Buttons */
        button {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            border: 1px solid var(--apple-border);
            background-color: #FFFFFF;
            color: var(--apple-blue);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        button:hover {
            background-color: var(--apple-light-gray);
        }

        button.active {
            background-color: var(--apple-blue);
            color: #FFFFFF;
            border-color: var(--apple-blue);
        }

        /* Calendar Grid */
        .calendar {
            padding: 1.5rem;
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.5rem;
            max-width: 900px;
            margin: 0 auto;
            background-color: #FFFFFF;
            border-radius: 0 0 12px 12px;
        }

        .weekday {
            text-align: center;
            font-weight: 600;
            color: var(--apple-gray);
            font-size: 0.9rem;
            padding: 0.5rem;
        }

        /* Weekend Highlighting */
        .weekday:nth-child(1), 
        .weekday:nth-child(7) {
            color: var(--apple-red);
        }

        .day:nth-child(7n + 1),
        .day:nth-child(7n) {
            background-color: var(--apple-light-gray);
        }

        .day {
            aspect-ratio: 1;
            border: 1px solid var(--apple-border);
            border-radius: 8px;
            padding: 0.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            background-color: #FFFFFF;
        }

        .day:hover {
            background-color: var(--apple-light-gray);
        }

        .day.selected {
            background-color: var(--apple-blue);
            color: #FFFFFF;
            border-color: var(--apple-blue);
        }

        .day.holiday {
            background-color: var(--apple-light-gray);
            border-color: var(--apple-green);
        }

        .day .date {
            font-size: 1.1rem;
            font-weight: 500;
        }

        .day .indicator {
            font-size: 0.75rem;
            color: var(--apple-gray);
        }

        /* Region Selector */
        .region-select {
            padding: 0.5rem;
            border: 1px solid var(--apple-border);
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--apple-blue);
            background-color: #FFFFFF;
            cursor: pointer;
        }

        /* PTO Form */
        .pto-form {
            background: #FFFFFF;
            padding: 1.5rem;
            border-radius: 12px;
            margin-top: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .pto-form h3 {
            margin-bottom: 1rem;
            color: #1C1C1E;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #1C1C1E;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid var(--apple-border);
            border-radius: 8px;
            font-size: 0.9rem;
        }

        /* PTO Day Styling */
        .day.pto {
            background-color: var(--apple-blue);
            color: #FFFFFF;
            border-color: var(--apple-blue);
        }

        /* Export Button */
        .export-button {
            background-color: var(--apple-green);
            color: #FFFFFF;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 1rem;
        }

        .export-button:hover {
            opacity: 0.9;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .calendar {
                padding: 1rem;
                gap: 0.25rem;
            }

            .day {
                padding: 0.25rem;
            }

            .day .date {
                font-size: 0.9rem;
            }

            .controls {
                flex-wrap: wrap;
            }
        }
    </style>
    </head>
<body>
    <div class="calendar-container">
        <header class="header">
            <h1 class="title">PTO Calendar</h1>
            <select class="region-select" id="regionSelect">
                <option value="US">United States</option>
                <option value="UK">United Kingdom</option>
            </select>
        </header>

        <div class="controls">
            <button id="prevMonth">&larr; Previous</button>
            <h2 id="currentMonth">January 2024</h2>
            <button id="nextMonth">Next &rarr;</button>
        </div>

        <div class="calendar" id="calendar">
            <!-- Calendar grid will be populated by JavaScript -->
        </div>
    </div>

    <div class="pto-form">
        <h3>Add PTO Days</h3>
        <form id="ptoForm">
            <div class="form-group">
                <label for="ptoStart">Start Date:</label>
                <input type="date" id="ptoStart" required>
            </div>
            <div class="form-group">
                <label for="ptoEnd">End Date:</label>
                <input type="date" id="ptoEnd" required>
            </div>
            <div class="form-group">
                <label for="ptoType">Type:</label>
                <select id="ptoType">
                    <option value="vacation">Vacation</option>
                    <option value="sick">Sick Leave</option>
                    <option value="personal">Personal Day</option>
                </select>
            </div>
            <button type="submit" class="export-button">Add PTO</button>
        </form>
        <button id="exportButton" class="export-button">Export Schedule</button>
    </div>
    <script>
        class Calendar {
            constructor() {
                this.currentDate = new Date();
                this.selectedDate = null;
                this.region = 'US';
                this.ptoDays = new Set();
                this.ptoDetails = new Map(); // Store PTO details for export
                
                this.initializeElements();
                this.addEventListeners();
                this.render();
            }

            initializeElements() {
                this.calendarElement = document.getElementById('calendar');
                this.regionSelect = document.getElementById('regionSelect');
                this.currentMonthElement = document.getElementById('currentMonth');
                this.prevMonthButton = document.getElementById('prevMonth');
                this.nextMonthButton = document.getElementById('nextMonth');
                this.ptoForm = document.getElementById('ptoForm');
                this.exportButton = document.getElementById('exportButton');
            }

            addEventListeners() {
                this.prevMonthButton.addEventListener('click', () => this.previousMonth());
                this.nextMonthButton.addEventListener('click', () => this.nextMonth());
                this.regionSelect.addEventListener('change', (e) => {
                    this.region = e.target.value;
                    this.render();
                });
                
                // PTO form submission
                this.ptoForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.addPTODays();
                });

                // Export functionality
                this.exportButton.addEventListener('click', () => this.exportSchedule());
            }
            addPTODays() {
                const startDate = new Date(document.getElementById('ptoStart').value);
                const endDate = new Date(document.getElementById('ptoEnd').value);
                const ptoType = document.getElementById('ptoType').value;

                let currentDate = new Date(startDate);
                while (currentDate <= endDate) {
                    // Skip weekends
                    if (currentDate.getDay() !== 0 && currentDate.getDay() !== 6) {
                        const dateString = this.formatDate(currentDate);
                        this.ptoDays.add(dateString);
                        this.ptoDetails.set(dateString, {
                            type: ptoType,
                            date: new Date(currentDate)
                        });
                    }
                    currentDate.setDate(currentDate.getDate() + 1);
                }

                this.render();
                this.ptoForm.reset();
            }

            exportSchedule() {
                const schedule = {
                    ptoDays: [],
                    holidays: this.getHolidaysForYear(this.currentDate.getFullYear())
                };

                // Convert PTO details to array
                this.ptoDetails.forEach((details, date) => {
                    schedule.ptoDays.push({
                        date: date,
                        type: details.type
                    });
                });

                // Create and download file
                const blob = new Blob([JSON.stringify(schedule, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'pto-schedule.json';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }

            getHolidaysForYear(year) {
                const holidays = {
                    US: {},
                    UK: {}
                };

                // US Holidays
                holidays.US[`${year}-01-01`] = "New Year's Day";
                holidays.US[`${year}-01-${this.getNthDayOfMonth(year, 0, 3, 1)}`] = "Martin Luther King Jr. Day"; // 3rd Monday of January
                holidays.US[`${year}-02-${this.getNthDayOfMonth(year, 1, 3, 1)}`] = "Presidents Day"; // 3rd Monday of February
                holidays.US[`${year}-05-${this.getLastDayOfMonth(year, 4, 1)}`] = "Memorial Day"; // Last Monday of May
                holidays.US[`${year}-07-04`] = "Independence Day";
                holidays.US[`${year}-09-${this.getNthDayOfMonth(year, 8, 1, 1)}`] = "Labor Day"; // 1st Monday of September
                holidays.US[`${year}-11-${this.getNthDayOfMonth(year, 10, 4, 4)}`] = "Thanksgiving Day"; // 4th Thursday of November
                holidays.US[`${year}-12-25`] = "Christmas Day";

                // UK Holidays
                holidays.UK[`${year}-01-01`] = "New Year's Day";
                holidays.UK[`${year}-05-${this.getNthDayOfMonth(year, 4, 1, 1)}`] = "Early May Bank Holiday";
                holidays.UK[`${year}-05-${this.getLastDayOfMonth(year, 4, 1)}`] = "Spring Bank Holiday";
                holidays.UK[`${year}-08-${this.getLastDayOfMonth(year, 7, 1)}`] = "Summer Bank Holiday";
                holidays.UK[`${year}-12-25`] = "Christmas Day";
                holidays.UK[`${year}-12-26`] = "Boxing Day";

                return holidays;
            }

            getNthDayOfMonth(year, month, nth, dayOfWeek) {
                let date = new Date(year, month, 1);
                let count = 0;
                
                while (count < nth) {
                    if (date.getDay() === dayOfWeek) {
                        count++;
                    }
                    if (count < nth) {
                        date.setDate(date.getDate() + 1);
                    }
                }
                
                return date.getDate();
            }

            getLastDayOfMonth(year, month, dayOfWeek) {
                let date = new Date(year, month + 1, 0);
                
                while (date.getDay() !== dayOfWeek) {
                    date.setDate(date.getDate() - 1);
                }
                
                return date.getDate();
            }

            formatDate(date) {
                return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
            }

            isHoliday(date) {
                const formattedDate = this.formatDate(date);
                const yearHolidays = this.getHolidaysForYear(date.getFullYear());
                return yearHolidays[this.region][formattedDate];
            }

            previousMonth() {
                this.currentDate.setMonth(this.currentDate.getMonth() - 1);
                this.render();
            }

            nextMonth() {
                this.currentDate.setMonth(this.currentDate.getMonth() + 1);
                this.render();
            }
            render() {
                const year = this.currentDate.getFullYear();
                const month = this.currentDate.getMonth();
                
                // Update month display
                const monthName = new Date(year, month).toLocaleString('default', { month: 'long' });
                this.currentMonthElement.textContent = `${monthName} ${year}`;

                // Clear calendar
                this.calendarElement.innerHTML = '';

                // Add weekday headers
                const weekdays = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
                weekdays.forEach(day => {
                    const dayElement = document.createElement('div');
                    dayElement.className = 'weekday';
                    dayElement.textContent = day;
                    this.calendarElement.appendChild(dayElement);
                });

                // Get first day of month and number of days
                const firstDay = new Date(year, month, 1).getDay();
                const daysInMonth = new Date(year, month + 1, 0).getDate();

                // Add empty cells for days before start of month
                for (let i = 0; i < firstDay; i++) {
                    const emptyDay = document.createElement('div');
                    emptyDay.className = 'day';
                    this.calendarElement.appendChild(emptyDay);
                }

                // Add days of month
                for (let day = 1; day <= daysInMonth; day++) {
                    const date = new Date(year, month, day);
                    const dayElement = document.createElement('div');
                    dayElement.className = 'day';
                    
                    const dateSpan = document.createElement('span');
                    dateSpan.className = 'date';
                    dateSpan.textContent = day;
                    dayElement.appendChild(dateSpan);

                    const formattedDate = this.formatDate(date);
                    
                    // Check for PTO
                    if (this.ptoDays.has(formattedDate)) {
                        dayElement.classList.add('pto');
                        const ptoDetail = this.ptoDetails.get(formattedDate);
                        const indicator = document.createElement('span');
                        indicator.className = 'indicator';
                        indicator.textContent = ptoDetail.type;
                        dayElement.appendChild(indicator);
                    }

                    // Check for holidays
                    const holidayName = this.isHoliday(date);
                    if (holidayName) {
                        dayElement.classList.add('holiday');
                        const indicator = document.createElement('span');
                        indicator.className = 'indicator';
                        indicator.textContent = holidayName;
                        dayElement.appendChild(indicator);
                    }

                    dayElement.addEventListener('click', () => {
                        const selected = this.calendarElement.querySelector('.selected');
                        if (selected) selected.classList.remove('selected');
                        dayElement.classList.add('selected');
                        this.selectedDate = date;
                    });

                    this.calendarElement.appendChild(dayElement);
                }
            }
        }

        // Initialize calendar when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new Calendar();
        });
    </script>
</body>
</html>
